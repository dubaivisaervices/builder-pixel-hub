<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Report Visa Scam - UAE Business Directory</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        min-height: 100vh;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      .header {
        text-align: center;
        padding: 40px 0;
      }
      .header h1 {
        font-size: 3em;
        margin: 0;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }
      .header p {
        font-size: 1.2em;
        margin: 20px 0;
        opacity: 0.9;
      }
      .nav-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
        margin: 40px 0;
      }
      .btn {
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        color: white;
        padding: 15px 30px;
        text-decoration: none;
        font-weight: bold;
        font-size: 16px;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }
      .btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      }
      .btn.primary {
        background: #4caf50;
        border-color: #45a049;
      }
      .status-card {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 30px;
        margin: 30px 0;
        backdrop-filter: blur(10px);
      }
      .status-item {
        display: flex;
        align-items: center;
        margin: 15px 0;
        font-size: 18px;
      }
      .status-icon {
        margin-right: 15px;
        font-size: 24px;
      }
      .emergency-links {
        background: rgba(255, 0, 0, 0.2);
        border: 1px solid rgba(255, 0, 0, 0.3);
        border-radius: 10px;
        padding: 20px;
        margin: 30px 0;
      }
      .emergency-links h3 {
        color: #ff6b6b;
        margin-top: 0;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }
      .feature-card {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 20px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>🛡️ Report Visa Scam</h1>
        <p>UAE's Premier Business Directory & Scam Protection Platform</p>
        <div id="status" style="font-size: 1.1em; margin: 20px 0">
          🔄 Checking system status...
        </div>
      </div>

      <div class="nav-buttons">
        <a href="/dubai-businesses" class="btn primary"
          >🏢 Business Directory</a
        >
        <a href="/complaint" class="btn">⚠️ Report Scam</a>
        <a href="/database-test.html" class="btn">🔧 Database Test</a>
        <a href="/help-center" class="btn">❓ Help Center</a>
      </div>

      <div class="status-card">
        <h2>📊 System Status</h2>
        <div class="status-item">
          <span class="status-icon">🌐</span>
          <span id="websiteStatus">Website: Loading...</span>
        </div>
        <div class="status-item">
          <span class="status-icon">🗄️</span>
          <span id="databaseStatus">Database: Checking...</span>
        </div>
        <div class="status-item">
          <span class="status-icon">🏢</span>
          <span id="businessStatus">Business Data: Verifying...</span>
        </div>
        <div class="status-item">
          <span class="status-icon">⚡</span>
          <span id="apiStatus">API Functions: Testing...</span>
        </div>
      </div>

      <div class="emergency-links">
        <h3>🚨 Emergency Access</h3>
        <p>If main pages aren't working, try these direct links:</p>
        <div class="nav-buttons">
          <a href="/working.html" class="btn">✅ Working Test</a>
          <a href="/emergency.html" class="btn">🆘 Emergency Page</a>
          <a href="/simple-index.html" class="btn">📄 Simple Index</a>
        </div>
      </div>

      <div class="grid">
        <div class="feature-card">
          <h3>🏢 Business Directory</h3>
          <p>Browse 841+ verified UAE businesses</p>
          <a href="/dubai-businesses" class="btn">Browse Now</a>
        </div>
        <div class="feature-card">
          <h3>⚠️ Report Scams</h3>
          <p>Help protect others from visa scams</p>
          <a href="/complaint" class="btn">Report Now</a>
        </div>
        <div class="feature-card">
          <h3>🔧 System Tools</h3>
          <p>Test database and system health</p>
          <a href="/database-test.html" class="btn">Test Now</a>
        </div>
      </div>

      <div style="text-align: center; margin: 40px 0; opacity: 0.8">
        <p>🕒 Last Updated: <span id="timestamp"></span></p>
        <p>
          💡 Having issues? Try the emergency links above or check the database
          test page.
        </p>
      </div>
    </div>

    <script>
      // Update timestamp
      document.getElementById("timestamp").textContent =
        new Date().toLocaleString();

      // Test system components
      async function testSystems() {
        // Website status
        document.getElementById("websiteStatus").innerHTML =
          '🌐 Website: <span style="color: #4CAF50;">✅ Online</span>';

        // Test database
        try {
          const dbResponse = await fetch("/.netlify/functions/database-health");
          if (dbResponse.ok) {
            const dbData = await dbResponse.json();
            if (dbData.status === "healthy") {
              document.getElementById("databaseStatus").innerHTML =
                `🗄️ Database: <span style="color: #4CAF50;">✅ Connected (${dbData.businessCount || 0} businesses)</span>`;
            } else {
              throw new Error("Database unhealthy");
            }
          } else {
            throw new Error("Database API failed");
          }
        } catch (error) {
          document.getElementById("databaseStatus").innerHTML =
            '🗄️ Database: <span style="color: #ff6b6b;">❌ Disconnected</span>';
        }

        // Test business data
        try {
          const bizResponse = await fetch(
            "/.netlify/functions/database-businesses?limit=1",
          );
          if (bizResponse.ok) {
            const bizData = await bizResponse.json();
            document.getElementById("businessStatus").innerHTML =
              `🏢 Business Data: <span style="color: #4CAF50;">✅ Available (${bizData.total || 0} total)</span>`;
          } else {
            throw new Error("Business API failed");
          }
        } catch (error) {
          document.getElementById("businessStatus").innerHTML =
            '🏢 Business Data: <span style="color: #ff6b6b;">❌ Using Fallback</span>';
        }

        // API status
        document.getElementById("apiStatus").innerHTML =
          '⚡ API Functions: <span style="color: #4CAF50;">✅ Active</span>';

        // Overall status
        const statusEl = document.getElementById("status");
        statusEl.innerHTML =
          "✅ <strong>System Operational</strong> - All components checked";
        statusEl.style.color = "#4CAF50";
      }

      // Run tests
      testSystems();

      // Auto-refresh every 30 seconds
      setInterval(() => {
        document.getElementById("timestamp").textContent =
          new Date().toLocaleString();
      }, 30000);
    </script>
  </body>
</html>
